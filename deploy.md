Инструкция по развертыванию Mars DAO на mainnet / testnet
=========================================================

0. Станция для развертывания: GNU/Linux (тестировалось на Fedora 29 / Debian 9 / Ubuntu 18.04)
с графическим интерфейсом (т.к. нужен Frame для подписания транзакций при вызовах Aragon CLI).

Кошелек с достаточным количеством ETH для подписания 50+ транзакций в mainnet / testnet
**и известным Private Key** (потребуется использовать Frame в режиме "Hot", пока не починили
поддержку hardware wallets в нём).

1. Установка окружения (все от обычного юзера кроме 0):
  0. (Пользователь root): установка платформо-специфичных пакетов для сборки зависимостей.
  Зависит от платформы. Для Ubuntu:
  `apt update`
  `apt install build-essential python`
  1. NVM: https://github.com/nvm-sh/nvm
  Проверка: команда `nvm` выводит справку.
  2. Установка NodeJS / NPM через NVM:
  `nvm install --lts`
  `nvm use --lts`
  Проверка: `nvm current` и `node -v` выдают актуальную LTS-версию NodeJS.
  Если работаем в нескольких окнах терминала (один для Frame другой для Deploy например)
  - проверяем работу `nvm` и активную версию в каждом окне.
  3. Установка Frame из исходников: `git clone https://github.com/floating/frame`
  4. Прописываем в папке Frame файл hot.json с приватным ключом ETH-кошелька согласно
  инструкции: https://github.com/floating/frame#add-hot-signers
  5. Запуск Frame с поддержкой hot.json:
  `npm install`
  `npm run hot`
  Должно появиться окно Frame, активируем в нем кошелек и копируем адрес.
  6. Установка Aragon CLI:
    `npm install -g @aragon/cli`
    `npm upgrade -g @aragon/cli`
  7. Установка зависимостей скрипта развертывания (из папки проекта):
    `npm install`

2. Развертывание DAO. В отдельной папке со скриптом развертывания (например, имя скрипта - `stage1.js`):
  0. Вписываем в переменную `env` тип сети - `rinkeby` или `mainnet`.
  1. Вписываем адрес из Frame в константу `owner` в скрипте.
  От этого адреса будет развернуто DAO.
  2. Корректируем массив `tokens` - в свойстве `holders` указываем адреса первичных
  владельцев токенов и количество токенов при создании, кворумы, консенсусы 
  и периоды голосований.
  (Умножение на константы `tu`/`percent` - не трогать).
  3. Запускаем скрипт: `node stage1.js`. Мониторим процесс выполнения и реагируем на запросы:
    1. Если требуется подписать транзакцию - делаем это в окне Frame.
    2. Скрипт рассчитан на ручную рекацию пользователя при ошибках вызовов Aragon CLI.
    Если очередная команда завершилась с не-нулевым кодом (ошибка), то скрипт сделает паузу
    с запросом `Press ENTER to repeat, enter return value to continue`.
    Возможные виды ошибок и как реагировать:
      1. Неудачное выполнение команды - дело не дошло до создания транзакции или сама
      транзакция в ходе вызова команды не выполнена.
      Тогда команду требуется повторить.
      **Пользователь просто нажимает ENTER.**
      *На практике, встречалось только на devchain и на более ранних версиях Aragon CLI.*
      *Возможно также при сбоях работы Интернета при деплое, а также при ошибках соединения*
      *с используемыми "под капотом" провайдерами блокчейна, узлов IPFS и т.п.*
      2. Ложно-отрицательное срабатывание команды - когда необходимая для выполнения
      транзакция прошла успешно и попала в блокчейн, но CLI не смог по какой-то причине
      извлечь дополнительную информацию для вывода на экран.
      Тогда команду повторять не требуется (да и не получится в принципе).
      **Пользователь вводит любой символ/текст и нажимает ENTER.**
      *На практике, реально встречалось при развертывании на Rinkeby.*
      *Ошибка встречалась исключительно на вызовах `dao acl create`, достаточно часто.*
      *Ввод любого текста допустим, если вывод команды не парсится и не используется далее*
      *(что действительно так для `dao acl ...`)*
      *в скрипте, иначе надо вводить осмысленный идентификатор по смыслу вызываемого кода.*
      *Ситуация из "иначе" пока гипотетическая, но при возникновении, решать надо при детальном понимании,*
      *как работает код скрипта и Aragon CLI.*
    3. По окончании будут выведены `dao apps`, `dao acl`, статистика неудачных вызовов, адрес DAO.
